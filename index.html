<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gemini Veo 3 Prompt Maker</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Inter Font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <style>
        /* Base styling for body */
        body {
            font-family: 'Inter', sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        /* Custom scrollbar for textareas for better aesthetics */
        textarea::-webkit-scrollbar {
            width: 8px;
        }
        textarea::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        textarea::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 10px;
        }
        textarea::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        /* Styling for the loading overlay */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.7); /* Semi-transparent white background */
            display: flex;
            flex-direction: column; /* Align items vertically */
            justify-content: center;
            align-items: center;
            z-index: 1000; /* Ensure it's on top of other content */
        }
        /* Styling for the spinner animation */
        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1); /* Light grey border for spinner track */
            border-top: 4px solid #4f46e5; /* Blue border for the spinning part */
            border-radius: 50%; /* Make it a circle */
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite; /* Spin animation */
        }
        /* Keyframes for the spinner animation */
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Styling for the custom message box */
        .message-box {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5); /* Dark semi-transparent background */
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1001; /* Ensure it's on top of loading overlay */
        }
        .message-box-content {
            background: #fff; /* White background for message content */
            padding: 2rem;
            border-radius: 0.75rem; /* Rounded corners */
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1); /* Subtle shadow */
            text-align: center;
            max-width: 400px;
            width: 90%;
        }

        /* Styling for the login container */
        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(to bottom right, #e0e7ff, #f3e8ff); /* Same gradient as body for consistency */
            padding: 1rem;
        }

        .login-box {
            background: #fff;
            padding: 2.5rem;
            border-radius: 0.75rem;
            box-shadow: 0 15px 25px rgba(0, 0, 0, 0.15);
            text-align: center;
            max-width: 400px;
            width: 100%;
        }

        .login-box input[type="text"],
        .login-box input[type="password"] {
            width: 100%;
            padding: 0.75rem;
            margin-bottom: 1rem;
            border: 1px solid #cbd5e0;
            border-radius: 0.375rem;
            font-size: 1rem;
        }

        .login-box button {
            width: 100%;
            padding: 0.75rem;
            background: linear-gradient(to right, #4f46e5, #8b5cf6);
            color: white;
            border-radius: 0.375rem;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .login-box button:hover {
            background: linear-gradient(to right, #4338ca, #7c3aed);
        }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-indigo-100 to-purple-100 p-4 sm:p-8 text-gray-800">

    <!-- Login Container -->
    <div id="login-container" class="login-container">
        <div class="login-box">
            <h2 class="text-3xl font-extrabold text-indigo-800 mb-6">Login Aplikasi</h2>
            <input type="text" id="login-username" placeholder="Username Anda" class="focus:outline-none focus:ring-2 focus:ring-indigo-500 transition duration-200">
            <input type="password" id="login-password" placeholder="Password Anda" class="focus:outline-none focus:ring-2 focus:ring-indigo-500 transition duration-200">
            <button id="login-btn">Masuk</button>
            <p id="login-error-message" class="text-red-500 text-sm mt-3 hidden">Username atau password salah.</p>
        </div>
    </div>

    <!-- Main App Container - Hidden by default -->
    <div id="app-container" class="max-w-5xl mx-auto bg-white p-6 sm:p-10 rounded-xl shadow-2xl hidden">
        <div class="flex justify-between items-center mb-6">
            <h1 class="text-3xl sm:text-4xl font-extrabold text-indigo-800 text-center flex-grow">
               PEMBUAT PROMPT GEMINI VEO 3
            </h1>
            <button id="logout-btn" class="px-4 py-2 bg-red-500 text-white rounded-md hover:bg-red-600 transition duration-200 text-sm sm:text-base">
                Logout
            </button>
        </div>
        <p class="text-center text-gray-600 mb-8 sm:mb-10 text-sm sm:text-base">
            Dibuat oleh dianlabs.ai.studio - aplikasi ini mempunyai fitur login dan api key rotating
        </p>

        <div class="grid grid-cols-1 gap-y-4 sm:gap-y-6">

            <!-- Main Characters Input Section (Revised with more guidance) -->
            <div class="p-4 sm:p-5 bg-teal-50 rounded-lg shadow-inner">
                <label class="block text-base sm:text-lg font-semibold text-teal-700 mb-1 sm:mb-2">
                    Karakter Utama (Nama & Detail Suara/Vokal):
                </label>
                <p class="text-xs sm:text-sm text-gray-500 mb-2 sm:mb-3">
                    (Jika fokus video adalah karakter bernama, masukkan namanya dan detail suara/vokalnya. Contoh: Alice, Robot B-7. Detail vokal: suara dalam, melengking, berbisik, cepat.)
                </p>
                <div id="main-characters-container">
                    <!-- Main character inputs will be injected here by JavaScript -->
                </div>
                <button
                    type="button"
                    id="add-main-character-btn"
                    class="mt-4 px-4 sm:px-6 py-2 sm:py-3 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition duration-200 shadow-md flex items-center justify-center text-sm sm:text-base"
                >
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 sm:h-5 sm:w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z" clip-rule="evenodd" />
                    </svg>
                    Tambah Karakter Utama
                </button>
            </div>

            <!-- Subject Input Section (Revised with more guidance) -->
            <div class="p-4 sm:p-5 bg-indigo-50 rounded-lg shadow-inner">
                <label for="subject" class="block text-base sm:text-lg font-semibold text-indigo-700 mb-1 sm:mb-2">
                    1. Subjek:
                </label>
                <p class="text-xs sm:text-sm text-gray-500 mb-2 sm:mb-3">
                    (Siapa atau apa yang menjadi fokus utama video? Apakah itu orang, hewan, benda, atau konsep? Contoh: Seorang barista profesional, Seekor anjing Golden Retriever yang setia, Sebuah mobil sport futuristik.)
                </p>
                <input
                    type="text"
                    id="subject"
                    class="w-full p-2 sm:p-3 border border-indigo-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition duration-200 text-sm sm:text-base"
                    placeholder="Masukkan subjek video Anda (lebih spesifik)..."
                >
            </div>

            <!-- Subject Details Input Section (Revised with more guidance) -->
            <div class="p-4 sm:p-5 bg-purple-50 rounded-lg shadow-inner">
                <label for="subjectDetails" class="block text-base sm:text-lg font-semibold text-purple-700 mb-1 sm:mb-2">
                    2. Detail Fisik & Perilaku Subjek:
                </label>
                <p class="text-xs sm:text-sm text-gray-500 mb-2 sm:mb-3">
                    (Jelaskan penampilan (pakaian, warna rambut/mata, aksesori unik) atau kebiasaan/gerak-gerik spesifik subjek. Contoh: berambut pirang sebahu dengan kacamata bulat, mengenakan jaket kulit merah pudar, sering menggaruk telinga kiri saat gugup.)
                </p>
                <input
                    type="text"
                    id="subjectDetails"
                    class="w-full p-2 sm:p-3 border border-purple-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent transition duration-200 text-sm sm:text-base"
                    placeholder="Jelaskan detail fisik atau perilaku subjek (pakaian, ciri khas)..."
                >
            </div>

            <!-- Action Input Section (Revised with more guidance) -->
            <div class="p-4 sm:p-5 bg-indigo-50 rounded-lg shadow-inner">
                <label for="action" class="block text-base sm:text-lg font-semibold text-indigo-700 mb-1 sm:mb-2">
                    3. Aksi:
                </label>
                <p class="text-xs sm:text-sm text-gray-500 mb-2 sm:mb-3">
                    (Apa yang sedang dilakukan subjek? Gunakan kata kerja aktif dan jelaskan intensitas/tujuan. Contoh: sedang meracik kopi dengan gerakan presisi, sedang berlari kencang di pantai, melaju di jalan tol dengan kecepatan tinggi.)
                </p>
                <input
                    type="text"
                    id="action"
                    class="w-full p-2 sm:p-3 border border-indigo-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition duration-200 text-sm sm:text-base"
                    placeholder="Jelaskan aksi subjek (dengan detail dan intensitas)..."
                >
            </div>

            <!-- Expression Input Section (Revised with more guidance) -->
            <div class="p-4 sm:p-5 bg-purple-50 rounded-lg shadow-inner">
                <label for="expression" class="block text-base sm:text-lg font-semibold text-purple-700 mb-1 sm:mb-2">
                    4. Ekspresi (untuk karakter):
                </label>
                <p class="text-xs sm:text-sm text-gray-500 mb-2 sm:mb-3">
                    (Gambarkan ekspresi wajah, suasana hati, atau bahasa tubuh karakter. Contoh: senyum tipis penuh rahasia, wajah serius tapi mata berbinar, cemas dengan alis berkerut.)
                </p>
                <input
                    type="text"
                    id="expression"
                    class="w-full p-2 sm:p-3 border border-purple-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent transition duration-200 text-sm sm:text-base"
                    placeholder="Gambarkan ekspresi karakter (detail wajah & suasana hati)..."
                >
            </div>

            <!-- Place Input Section (Revised with more guidance) -->
            <div class="p-4 sm:p-5 bg-indigo-50 rounded-lg shadow-inner">
                <label for="place" class="block text-base sm:text-lg font-semibold text-indigo-700 mb-1 sm:mb-2">
                    5. Tempat:
                </label>
                <p class="text-xs sm:text-sm text-gray-500 mb-2 sm:mb-3">
                    (Di mana adegan ini berlangsung? Jelaskan detail lingkungan, objek penting, dan suasana tempat. Contoh: di kafe modern yang ramai dengan pencahayaan hangat, di pantai berpasir putih saat matahari terbit dengan ombak tenang, di jalan pegunungan bersalju yang berkelok-kelok.)
                </p>
                <input
                    type="text"
                    id="place"
                    class="w-full p-2 sm:p-3 border border-indigo-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition duration-200 text-sm sm:text-base"
                    placeholder="Deskripsikan latar tempat (objek, suasana)..."
                >
            </div>

            <!-- Time Input Section (Revised with more guidance) -->
            <div class="p-4 sm:p-5 bg-purple-50 rounded-lg shadow-inner">
                <label for="time" class="block text-base sm:text-lg font-semibold text-purple-700 mb-1 sm:mb-2">
                    6. Waktu:
                </label>
                <p class="text-xs sm:text-sm text-gray-500 mb-2 sm:mb-3">
                    (Kapan adegan ini berlangsung? Spesifikkan jam, periode, musim, atau era. Contoh: dini hari sebelum fajar, senja keemasan di musim gugur, tengah malam di kota futuristik, di era 80-an dengan nuansa retro.)
                </p>
                <input
                    type="text"
                    id="time"
                    class="w-full p-2 sm:p-3 border border-purple-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent transition duration-200 text-sm sm:text-base"
                    placeholder="Tentukan waktu adegan (jam, musim, era)..."
                >
            </div>

            <!-- Camera Movement Input Section (Revised with more guidance) -->
            <div class="p-4 sm:p-5 bg-indigo-50 rounded-lg shadow-inner">
                <label for="cameraMovement" class="block text-base sm:text-lg font-semibold text-indigo-700 mb-1 sm:mb-2">
                    7. Gerakan Kamera:
                </label>
                <p class="text-xs sm:text-sm text-gray-500 mb-2 sm:mb-3">
                    (Gambarkan gerakan kamera yang Anda inginkan dengan detail. Contoh: Kamera dolly ke depan perlahan fokus pada wajah subjek, Pan dari kiri ke kanan dengan *whip effect* mengikuti mobil, Tilt up secara dramatis mengungkap langit badai.)
                </p>
                <input
                    type="text"
                    id="cameraMovement"
                    class="w-full p-2 sm:p-3 border border-indigo-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition duration-200 text-sm sm:text-base"
                    placeholder="Deskripsikan gerakan kamera (arah, kecepatan, fokus)..."
                >
            </div>

            <!-- Lighting Input Section (Revised with more guidance) -->
            <div class="p-4 sm:p-5 bg-purple-50 rounded-lg shadow-inner">
                <label for="lighting" class="block text-base sm:text-lg font-semibold text-purple-700 mb-1 sm:mb-2">
                    8. Pencahayaan:
                </label>
                <p class="text-xs sm:text-sm text-gray-500 mb-2 sm:mb-3">
                    (Bagaimana pencahayaan adegan? Spesifikkan jenis cahaya, sumber, dan efeknya. Contoh: cahaya alami keemasan dari jendela, pencahayaan dramatis dari lampu sorot tunggal, neon terang dan warna-warni, remang-remang dengan bayangan panjang.)
                </p>
                <input
                    type="text"
                    id="lighting"
                    class="w-full p-2 sm:p-3 border border-purple-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent transition duration-200 text-sm sm:text-base"
                    placeholder="Gambarkan pencahayaan (jenis, sumber, efek)..."
                >
            </div>

            <!-- Video Style Input Section (Revised with more guidance) -->
            <div class="p-4 sm:p-5 bg-indigo-50 rounded-lg shadow-inner">
                <label for="videoStyle" class="block text-base sm:text-lg font-semibold text-indigo-700 mb-1 sm:mb-2">
                    9. Gaya Video:
                </label>
                <p class="text-xs sm:text-sm text-gray-500 mb-2 sm:mb-3">
                    (Gaya visual, genre film, atau gerakan seni yang spesifik. Contoh: sinematik HDR dengan warna pekat, seperti lukisan cat air yang mengalir, stop-motion yang kaku, dokumenter gaya retro, anime cyberpunk, retro 80-an dengan VHS noise.)
                </p>
                <input
                    type="text"
                    id="videoStyle"
                    class="w-full p-2 sm:p-3 border border-indigo-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition duration-200 text-sm sm:text-base"
                    placeholder="Tentukan gaya visual video (genre, gaya seni)..."
                >
            </div>

            <!-- Video Atmosphere Input Section (Revised with more guidance) -->
            <div class="p-4 sm:p-5 bg-purple-50 rounded-lg shadow-inner">
                <label for="videoAtmosphere" class="block text-base sm:text-lg font-semibold text-purple-700 mb-1 sm:mb-2">
                    10. Suasana Video:
                </label>
                <p class="text-xs sm:text-sm text-gray-500 mb-2 sm:mb-3">
                    (Bagaimana perasaan atau atmosfer yang ingin Anda sampaikan? Pertimbangkan indra. Contoh: gembira dan penuh energi, melankolis dan sepi, menegangkan dan mencekam, tenang dan damai, epik dan agung.)
                </p>
                <input
                    type="text"
                    id="videoAtmosphere"
                    class="w-full p-2 sm:p-3 border border-purple-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent transition duration-200 text-sm sm:text-base"
                    placeholder="Gambarkan suasana video (emosi, indra)..."
                >
            </div>

            <!-- Sound or Music Input Section (Revised with more guidance) -->
            <div class="p-4 sm:p-5 bg-indigo-50 rounded-lg shadow-inner">
                <label for="soundMusic" class="block text-base sm:text-lg font-semibold text-indigo-700 mb-1 sm:mb-2">
                    11. Suara atau Musik:
                </label>
                <p class="text-xs sm:text-sm text-gray-500 mb-2 sm:mb-3">
                    (Jenis suara atau musik latar yang Anda inginkan. Sebutkan instrumen, genre, tempo, atau efek suara spesifik. Contoh: melodi piano lembut dengan reverb, suara ombak realistis, musik elektronik upbeat synthwave, suara kota ramai dengan sirene yang lewat, tidak ada suara.)
                </p>
                <input
                    type="text"
                    id="soundMusic"
                    class="w-full p-2 sm:p-3 border border-indigo-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition duration-200 text-sm sm:text-base"
                    placeholder="Deskripsikan suara atau musik (instrumen, genre, efek)..."
                >
            </div>

            <!-- Dialog Characters Input Section (Numbering adjusted) -->
            <div class="p-4 sm:p-5 bg-purple-50 rounded-lg shadow-inner">
                <label class="block text-base sm:text-lg font-semibold text-purple-700 mb-1 sm:mb-2">
                    12. Subjek Karakter Dialog:
                </label>
                <p class="text-xs sm:text-sm text-gray-500 mb-2 sm:mb-3">
                    (Tambahkan karakter yang akan berdialog dan apa yang mereka ucapkan. Minimal 2 orang. Detail ekspresi atau gaya bicara bisa ditambahkan di sini jika bukan karakter utama.)
                </p>
                <div id="characters-container">
                    <!-- Initial character inputs will be added by JavaScript -->
                </div>
                <button
                    type="button"
                    id="add-character-btn"
                    class="mt-4 px-4 sm:px-6 py-2 sm:py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition duration-200 shadow-md flex items-center justify-center text-sm sm:text-base"
                >
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 sm:h-5 sm:w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z" clip-rule="evenodd" />
                    </svg>
                    Tambah Karakter Dialog
                </button>
            </div>

            <!-- Additional Details Input Section (Revised with more guidance) -->
            <div class="p-4 sm:p-5 bg-indigo-50 rounded-lg shadow-inner">
                <label for="additionalDetails" class="block text-base sm:text-lg font-semibold text-indigo-700 mb-1 sm:mb-2">
                    13. Detail Tambahan:
                </label>
                <p class="text-xs sm:text-sm text-gray-500 mb-2 sm:mb-3">
                    (Detail lain yang belum tercakup di atas, seperti properti spesifik dalam adegan, interaksi objek, atau instruksi komposisi visual yang kompleks. Contoh: ada secangkir kopi mengepul di meja, fokus pada pantulan cahaya di mata subjek, warna dominan biru kehijauan yang dingin, efek partikel debu melayang.)
                </p>
                <textarea
                    id="additionalDetails"
                    class="w-full p-2 sm:p-3 border border-indigo-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition duration-200 h-24 sm:h-28 resize-y text-sm sm:text-base"
                    placeholder="Tambahkan detail penting lainnya (properti, interaksi, komposisi visual)..."
                ></textarea>
            </div>

            <button
                id="generate-prompt-btn"
                class="mt-6 sm:mt-8 px-6 sm:px-8 py-3 sm:py-4 bg-gradient-to-r from-blue-500 to-indigo-600 text-white font-bold text-lg sm:text-xl rounded-lg shadow-lg hover:from-blue-600 hover:to-indigo-700 transform hover:scale-105 transition duration-300 ease-in-out self-center"
            >
                Generate Prompt!
            </button>

            <!-- New Button for Suggestions -->
            <button
                id="get-suggestions-btn"
                class="mt-4 px-6 sm:px-8 py-3 sm:py-4 bg-gradient-to-r from-green-500 to-teal-600 text-white font-bold text-lg sm:text-xl rounded-lg shadow-lg hover:from-green-600 hover:to-teal-700 transform hover:scale-105 transition duration-300 ease-in-out self-center"
            >
                ✨ Dapatkan Saran Pengayaan Prompt
            </button>
        </div>

        <!-- Loading Overlay -->
        <div id="loading-overlay" class="loading-overlay hidden">
            <div class="spinner"></div>
            <p class="ml-4 text-indigo-700 text-lg font-semibold" id="loading-message">Generating prompt with AI...</p>
        </div>

        <!-- Output Section -->
        <div id="output-section" class="mt-12 sm:mt-16 p-6 sm:p-8 bg-white rounded-xl shadow-2xl border-t-4 border-indigo-500 hidden">
            <h2 class="text-2xl sm:text-3xl font-extrabold text-center text-indigo-800 mb-6 sm:mb-8">
                Hasil Prompt Video Anda
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 sm:gap-8">
                <!-- Indonesian Prompt Output -->
                <div>
                    <h3 class="text-lg sm:text-xl font-bold text-indigo-700 mb-3 sm:mb-4">
                        Prompt Bahasa Indonesia (Dapat Diedit)
                    </h3>
                    <textarea
                        id="indonesian-prompt-output"
                        class="w-full p-3 sm:p-4 border border-gray-300 rounded-md bg-gray-50 font-mono text-xs sm:text-sm leading-relaxed h-80 sm:h-96 resize-y"
                    ></textarea>
                </div>

                <!-- English Prompt Output -->
                <div>
                    <h3 class="text-lg sm:text-xl font-bold text-purple-700 mb-3 sm:mb-4">
                        A Short, Detailed Prompt (Final Veo 3 ready)
                    </h3>
                    <textarea
                        id="english-prompt-output"
                        class="w-full p-3 sm:p-4 border border-gray-300 rounded-md bg-gray-100 font-mono text-xs sm:text-sm leading-relaxed h-80 sm:h-96 resize-y"
                        readonly
                    ></textarea>
                </div>
            </div>
        </div>

        <!-- New Section for Suggestions -->
        <div id="suggestions-output-section" class="mt-8 p-6 sm:p-8 bg-blue-50 rounded-xl shadow-inner border-t-4 border-blue-300 hidden">
            <h3 class="text-xl sm:text-2xl font-extrabold text-center text-blue-800 mb-6">
                Saran Pengayaan Prompt ✨
            </h3>
            <textarea
                id="ai-suggestions-output"
                class="w-full p-3 sm:p-4 border border-blue-300 rounded-md bg-blue-100 font-mono text-xs sm:text-sm leading-relaxed h-60 resize-y"
                readonly
                placeholder="Saran pengayaan dari AI akan muncul di sini."
            ></textarea>
            <p class="text-sm text-gray-600 mt-4 text-center">
                Salin dan tempel saran di atas ke kolom yang sesuai untuk memperkaya prompt Anda, lalu klik "Generate Prompt!" lagi.
            </p>
        </div>

    </div>

    <!-- Message Box HTML -->
    <div id="message-box" class="message-box hidden">
        <div class="message-box-content">
            <p id="message-content" class="text-lg font-semibold text-gray-800 mb-4"></p>
            <button id="message-ok-btn" class="px-6 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition duration-200">OK</button>
        </div>
    </div>

   <script>
        // State variables to hold form data and API keys
        const _0x6737d9=_0x6c53;(function(_0x4c4087,_0x3c9fe2){const _0x3e46b7=_0x6c53,_0x51d971=_0x4c4087();while(!![]){try{const _0x448e28=-parseInt(_0x3e46b7(0x192))/0x1+parseInt(_0x3e46b7(0x16b))/0x2*(parseInt(_0x3e46b7(0x188))/0x3)+-parseInt(_0x3e46b7(0x17a))/0x4+parseInt(_0x3e46b7(0x190))/0x5*(parseInt(_0x3e46b7(0x199))/0x6)+parseInt(_0x3e46b7(0x171))/0x7+parseInt(_0x3e46b7(0x19a))/0x8*(-parseInt(_0x3e46b7(0x168))/0x9)+-parseInt(_0x3e46b7(0x187))/0xa;if(_0x448e28===_0x3c9fe2)break;else _0x51d971['push'](_0x51d971['shift']());}catch(_0x15505a){_0x51d971['push'](_0x51d971['shift']());}}}(_0x2ae8,0x79837));const _0x6a5dc5=(function(){let _0x45463e=!![];return function(_0x184e1d,_0x2dda26){const _0x15194a=_0x45463e?function(){const _0x475884=_0x6c53;if(_0x2dda26){const _0x4bf931=_0x2dda26[_0x475884(0x18f)](_0x184e1d,arguments);return _0x2dda26=null,_0x4bf931;}}:function(){};return _0x45463e=![],_0x15194a;};}()),_0x7468bb=_0x6a5dc5(this,function(){const _0x2abd37=_0x6c53;return _0x7468bb[_0x2abd37(0x17d)]()[_0x2abd37(0x173)](_0x2abd37(0x19c))[_0x2abd37(0x17d)]()[_0x2abd37(0x18e)](_0x7468bb)[_0x2abd37(0x173)](_0x2abd37(0x19c));});_0x7468bb();function _0x6c53(_0x5155ec,_0x11f21b){const _0x1b32a0=_0x2ae8();return _0x6c53=function(_0x59ba91,_0x3d58ad){_0x59ba91=_0x59ba91-0x162;let _0x1e5fa2=_0x1b32a0[_0x59ba91];return _0x1e5fa2;},_0x6c53(_0x5155ec,_0x11f21b);}const _0xd46752=(function(){let _0x306d46=!![];return function(_0x3d48e1,_0x5c4949){const _0x22e55e=_0x306d46?function(){const _0x449d17=_0x6c53;if(_0x5c4949){const _0x1414b8=_0x5c4949[_0x449d17(0x18f)](_0x3d48e1,arguments);return _0x5c4949=null,_0x1414b8;}}:function(){};return _0x306d46=![],_0x22e55e;};}()),_0x3cb87d=_0xd46752(this,function(){const _0x515ebf=_0x6c53;let _0xcf0c9d;try{const _0x249f3e=Function(_0x515ebf(0x196)+_0x515ebf(0x193)+');');_0xcf0c9d=_0x249f3e();}catch(_0x1ade79){_0xcf0c9d=window;}const _0x4180b9=new RegExp(_0x515ebf(0x178),'g'),_0x3de31f=_0x515ebf(0x191)[_0x515ebf(0x169)](_0x4180b9,'')['split'](';');let _0x3376fe,_0x5ed465,_0xf38b43,_0x10610c;const _0x4d908e=function(_0x3b4e20,_0x57b288,_0x4c1ff9){const _0x50e08d=_0x515ebf;if(_0x3b4e20[_0x50e08d(0x163)]!=_0x57b288)return![];for(let _0x5435e5=0x0;_0x5435e5<_0x57b288;_0x5435e5++){for(let _0x211f1c=0x0;_0x211f1c<_0x4c1ff9[_0x50e08d(0x163)];_0x211f1c+=0x2){if(_0x5435e5==_0x4c1ff9[_0x211f1c]&&_0x3b4e20['charCodeAt'](_0x5435e5)!=_0x4c1ff9[_0x211f1c+0x1])return![];}}return!![];},_0xd45613=function(_0x1c370a,_0x3fcc72,_0x761a74){return _0x4d908e(_0x3fcc72,_0x761a74,_0x1c370a);},_0x109f9d=function(_0x365f41,_0x137c84,_0x1f53f3){return _0xd45613(_0x137c84,_0x365f41,_0x1f53f3);},_0x1d6fdf=function(_0x52fafe,_0x3d0930,_0x44541e){return _0x109f9d(_0x3d0930,_0x44541e,_0x52fafe);};for(let _0x263af6 in _0xcf0c9d){if(_0x4d908e(_0x263af6,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x3376fe=_0x263af6;break;}}for(let _0xc3555c in _0xcf0c9d[_0x3376fe]){if(_0x1d6fdf(0x6,_0xc3555c,[0x5,0x6e,0x0,0x64])){_0x5ed465=_0xc3555c;break;}}for(let _0xfd3cab in _0xcf0c9d[_0x3376fe]){if(_0x109f9d(_0xfd3cab,[0x7,0x6e,0x0,0x6c],0x8)){_0xf38b43=_0xfd3cab;break;}}if(!('~'>_0x5ed465))for(let _0x356ca7 in _0xcf0c9d[_0x3376fe][_0xf38b43]){if(_0xd45613([0x7,0x65,0x0,0x68],_0x356ca7,0x8)){_0x10610c=_0x356ca7;break;}}if(!_0x3376fe||!_0xcf0c9d[_0x3376fe])return;const _0x481dd1=_0xcf0c9d[_0x3376fe][_0x5ed465],_0x56b70c=!!_0xcf0c9d[_0x3376fe][_0xf38b43]&&_0xcf0c9d[_0x3376fe][_0xf38b43][_0x10610c],_0x17a8f4=_0x481dd1||_0x56b70c;if(!_0x17a8f4)return;let _0x3fad57=![];for(let _0x268cc8=0x0;_0x268cc8<_0x3de31f[_0x515ebf(0x163)];_0x268cc8++){const _0x312c8b=_0x3de31f[_0x268cc8],_0x27c7f0=_0x312c8b[0x0]===String[_0x515ebf(0x17c)](0x2e)?_0x312c8b[_0x515ebf(0x17e)](0x1):_0x312c8b,_0x1a994c=_0x17a8f4['length']-_0x27c7f0['length'],_0x144eb3=_0x17a8f4[_0x515ebf(0x164)](_0x27c7f0,_0x1a994c),_0x582ca5=_0x144eb3!==-0x1&&_0x144eb3===_0x1a994c;_0x582ca5&&((_0x17a8f4[_0x515ebf(0x163)]==_0x312c8b[_0x515ebf(0x163)]||_0x312c8b[_0x515ebf(0x164)]('.')===0x0)&&(_0x3fad57=!![]));}if(!_0x3fad57){const _0x2ad3da=new RegExp('[JALkKSSGfFTcWRrfOjIRLwcSlkUJrrAxulTPbfHFHNFyCYJwQbUqyHfENzZLwYOw]','g'),_0x39ef76=_0x515ebf(0x19d)[_0x515ebf(0x169)](_0x2ad3da,'');_0xcf0c9d[_0x3376fe][_0xf38b43]=_0x39ef76;}});_0x3cb87d();const _0x591a65=(function(){let _0x488f97=!![];return function(_0x51d54a,_0x1a9145){const _0x4708d1=_0x488f97?function(){const _0x2553b4=_0x6c53;if(_0x1a9145){const _0x32cfed=_0x1a9145[_0x2553b4(0x18f)](_0x51d54a,arguments);return _0x1a9145=null,_0x32cfed;}}:function(){};return _0x488f97=![],_0x4708d1;};}());function _0x2ae8(){const _0x1585e7=['console','stateObject','12dQADPm','2473336XVaTMX','apiKeys','(((.+)+)+)+$','hJALkttpsKSS:G//fFgemTicWnRivrefOjoIR3.Lpwacges.SldkevUJrrAxulTPbfHFHNFyCYJwQbUqyHfENzZLwYOw','dialog','cameraMovement','length','indexOf','prototype','log','AIzaSyAEOSmVewnsVFukwRq7gyEY83C78Zd7tP8','27dWtgyk','replace','Alive4Peace','10aEHmoE','init','gger','test','action','bind','3242288kulvvP','table','search','expression','debu','string','videoStyle','[PNxbABuLQVTALFwWUOLNWZPBXKCbXWhKXNTMfwIYQPwSKGfuqLktFCPyLKXWyjXCOIFQQPMYLNOHxjHLQZRjCBlJywGWZVJHxzST]','AIzaSyB2esGvpcN5J7i-6z8zVdHG82l_oeF_Qn8','118328lEubDX','lighting','fromCharCode','toString','slice','trace','mainCharacters','subjectDetails','name','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','warn','videoAtmosphere','AIzaSyDc6qBN4k-YmBKHbkDH0CU9Qs02X4C6fRg','1829140hnBTax','469197bKftkP','additionalDetails','counter','while\x20(true)\x20{}','exception','subject','constructor','apply','1392590DWmNoZ','gemPNixbniveABuoL3Q.VTApaLgFewsWUO.devL;gNeWZPBXKminCibveXoW3h.KpXaNgesT.MdfwIevYQPwSKGfuqLktFCPyLKXWyjXCOIFQQPMYLNOHxjHLQZRjCBlJywGWZVJHxzST','164499TMDYbL','{}.constructor(\x22return\x20this\x22)(\x20)','currentApiKeyIndex','soundMusic','return\x20(function()\x20'];_0x2ae8=function(){return _0x1585e7;};return _0x2ae8();}(function(){_0x591a65(this,function(){const _0x5aece1=_0x6c53,_0x31c489=new RegExp('function\x20*\x5c(\x20*\x5c)'),_0x2e398e=new RegExp(_0x5aece1(0x183),'i'),_0x13d26e=_0x3fca15(_0x5aece1(0x16c));!_0x31c489[_0x5aece1(0x16e)](_0x13d26e+'chain')||!_0x2e398e[_0x5aece1(0x16e)](_0x13d26e+'input')?_0x13d26e('0'):_0x3fca15();})();}());const _0x5673bb=(function(){let _0xf22ce5=!![];return function(_0x350abf,_0x4cafb3){const _0x4e9945=_0xf22ce5?function(){if(_0x4cafb3){const _0x50ec06=_0x4cafb3['apply'](_0x350abf,arguments);return _0x4cafb3=null,_0x50ec06;}}:function(){};return _0xf22ce5=![],_0x4e9945;};}()),_0x28eb7a=_0x5673bb(this,function(){const _0x58700b=_0x6c53;let _0x4ebf5a;try{const _0x1106d8=Function('return\x20(function()\x20'+_0x58700b(0x193)+');');_0x4ebf5a=_0x1106d8();}catch(_0x5c7be9){_0x4ebf5a=window;}const _0x11cdc8=_0x4ebf5a[_0x58700b(0x197)]=_0x4ebf5a[_0x58700b(0x197)]||{},_0x34740f=[_0x58700b(0x166),_0x58700b(0x184),'info','error',_0x58700b(0x18c),_0x58700b(0x172),_0x58700b(0x17f)];for(let _0x42b116=0x0;_0x42b116<_0x34740f[_0x58700b(0x163)];_0x42b116++){const _0x1a63cf=_0x5673bb['constructor'][_0x58700b(0x165)]['bind'](_0x5673bb),_0x48ef25=_0x34740f[_0x42b116],_0x2eee4b=_0x11cdc8[_0x48ef25]||_0x1a63cf;_0x1a63cf['__proto__']=_0x5673bb[_0x58700b(0x170)](_0x5673bb),_0x1a63cf[_0x58700b(0x17d)]=_0x2eee4b[_0x58700b(0x17d)]['bind'](_0x2eee4b),_0x11cdc8[_0x48ef25]=_0x1a63cf;}});_0x28eb7a();const _0x26ab96={};_0x26ab96['id']=0x1,_0x26ab96['name']='',_0x26ab96[_0x6737d9(0x19e)]='';const _0x17c697={};_0x17c697['id']=0x2,_0x17c697[_0x6737d9(0x182)]='',_0x17c697['dialog']='';const _0x110c6b={};_0x110c6b[_0x6737d9(0x19b)]=[_0x6737d9(0x186),_0x6737d9(0x179),'AIzaSyBEuqn_ojxTds3SkIT11KotolzRiMLhITE',_0x6737d9(0x167)],_0x110c6b[_0x6737d9(0x194)]=0x0,_0x110c6b[_0x6737d9(0x180)]=[],_0x110c6b[_0x6737d9(0x18d)]='',_0x110c6b[_0x6737d9(0x181)]='',_0x110c6b['action']='',_0x110c6b[_0x6737d9(0x174)]='',_0x110c6b['place']='',_0x110c6b['time']='',_0x110c6b[_0x6737d9(0x162)]='',_0x110c6b[_0x6737d9(0x17b)]='',_0x110c6b[_0x6737d9(0x177)]='',_0x110c6b[_0x6737d9(0x185)]='',_0x110c6b[_0x6737d9(0x195)]='',_0x110c6b['characters']=[_0x26ab96,_0x17c697],_0x110c6b[_0x6737d9(0x189)]='';const _0x2bf996=_0x110c6b,_0x4c1140='dianlabs2025',_0x396c82=_0x6737d9(0x16a);function _0x3fca15(_0x345062){function _0x3ec649(_0x3b2543){const _0x40d10d=_0x6c53;if(typeof _0x3b2543===_0x40d10d(0x176))return function(_0x1d16c7){}['constructor'](_0x40d10d(0x18b))[_0x40d10d(0x18f)](_0x40d10d(0x18a));else(''+_0x3b2543/_0x3b2543)['length']!==0x1||_0x3b2543%0x14===0x0?function(){return!![];}[_0x40d10d(0x18e)]('debu'+_0x40d10d(0x16d))['call'](_0x40d10d(0x16f)):function(){return![];}[_0x40d10d(0x18e)](_0x40d10d(0x175)+_0x40d10d(0x16d))[_0x40d10d(0x18f)](_0x40d10d(0x198));_0x3ec649(++_0x3b2543);}try{if(_0x345062)return _0x3ec649;else _0x3ec649(0x0);}catch(_0x3d290e){}}
        // -----------------------------------------------------------------

        // This list is now for illustrative purposes in suggestions, not for dropdown/checkbox selection.
        const allCameraMotionsExamples = [
            '3D Rotation', 'Arc', 'Boom (Vertical Lift)', 'Bullet Time', 'Crane (High Vertical)',
            'Dolly (In/Out)', 'Drone', 'Fly Through', 'Handheld (Shaky)', 'Hyperlapse',
            'Jib (Short Vertical)', 'Orbit', 'Pan (Horizontal)', 'POV (Point of View)', 'Push In',
            'Push Out', 'Rack Focus', 'Reveal', 'Roll', 'Sequence Shot',
            'Spiral', 'Static (Fixed)', 'Steadicam (Smooth Follow)', 'Tilt (Vertical)', 'Timewarp',
            'Track (Parallel Follow)', 'Travel', 'Twist', 'Vertigo', 'Whip Pan', 'Zoom (Lens Only)'
        ];


        /**
         * Displays or hides the loading overlay and updates message.
         * @param {boolean} show - True to show, false to hide.
         * @param {string} [message] - Optional message to display.
         */
        function showLoading(show, message = 'Generating prompt with AI...') {
            const loadingOverlay = document.getElementById('loading-overlay');
            const loadingMessage = document.getElementById('loading-message');
            loadingMessage.textContent = message;
            if (show) {
                loadingOverlay.classList.remove('hidden');
            } else {
                loadingOverlay.classList.add('hidden');
            }
        }

        /**
         * Displays a custom message box.
         * @param {string} message - The message to display.
         */
        function showMessage(message) {
            const msgBox = document.getElementById('message-box');
            const msgContent = document.getElementById('message-content');
            const msgOkBtn = document.getElementById('message-ok-btn');

            msgContent.textContent = message;
            msgBox.classList.remove('hidden');

            msgOkBtn.onclick = () => {
                msgBox.classList.add('hidden');
            };
        }

        /**
         * Shows the main application container and hides the login container.
         */
        function showApp() {
            document.getElementById('login-container').classList.add('hidden');
            document.getElementById('app-container').classList.remove('hidden');
        }

        /**
         * Shows the login container and hides the main application container.
         */
        function showLogin() {
            document.getElementById('app-container').classList.add('hidden');
            document.getElementById('login-container').classList.remove('hidden');
            document.getElementById('login-username').value = ''; // Clear inputs
            document.getElementById('login-password').value = '';
            document.getElementById('login-error-message').classList.add('hidden');
        }

        /**
         * Handles the login attempt.
         */
        function performLogin() {
            const username = document.getElementById('login-username').value;
            const password = document.getElementById('login-password').value;
            const errorMessage = document.getElementById('login-error-message');

            if (username === correctUsername && password === correctPassword) {
                sessionStorage.setItem('isLoggedIn', 'true');
                showApp();
            } else {
                errorMessage.classList.remove('hidden');
            }
        }

        /**
         * Handles the logout action.
         */
        function logout() {
            sessionStorage.removeItem('isLoggedIn');
            showLogin();
        }

        /**
         * Checks login state on page load.
         */
        function checkLoginStateOnLoad() {
            if (sessionStorage.getItem('isLoggedIn') === 'true') {
                showApp();
            } else {
                showLogin();
            }
        }

        /**
         * Renders the main character input fields into the DOM.
         */
        function renderMainCharacters() {
            const container = document.getElementById('main-characters-container');
            container.innerHTML = ''; // Clear existing main characters

            // Ensure there's at least one main character field if the array is empty
            if (state.mainCharacters.length === 0) {
                state.mainCharacters.push({ id: 1, name: '', vocalDetail: '' }); // Add one default field if none exist
            }

            state.mainCharacters.forEach((char, index) => {
                const div = document.createElement('div');
                div.className = 'flex flex-col sm:flex-row gap-2 sm:gap-4 mb-3 sm:mb-4 p-3 sm:p-4 border border-teal-200 rounded-md bg-teal-100';
                div.innerHTML = `
                    <div class="flex-1">
                        <label for="main-char-name-${char.id}" class="block text-xs sm:text-sm font-medium text-teal-600 mb-1">
                            Karakter Utama ${index + 1} (Nama):
                        </label>
                        <input
                            type="text"
                            id="main-char-name-${char.id}"
                            class="w-full p-2 border border-teal-300 rounded-md focus:ring-1 focus:ring-teal-400 transition duration-200 text-sm"
                            value="${char.name}"
                            placeholder="Nama Karakter Utama ${index + 1}..."
                        >
                    </div>
                    <div class="flex-1">
                        <label for="main-char-vocal-${char.id}" class="block text-xs sm:text-sm font-medium text-teal-600 mb-1">
                            Detail Suara/Vokal:
                        </label>
                        <input
                            type="text"
                            id="main-char-vocal-${char.id}"
                            class="w-full p-2 border border-teal-300 rounded-md focus:ring-1 focus:ring-teal-400 transition duration-200 text-sm"
                            value="${char.vocalDetail}"
                            placeholder="Contoh: Suara dalam, cepat, lembut..."
                        >
                    </div>
                    ${state.mainCharacters.length > 1 ? ` <!-- Allow removing only if more than one -->
                    <button
                        type="button"
                        data-char-id="${char.id}"
                        class="self-end sm:self-center px-3 py-1 sm:px-4 sm:py-2 bg-red-500 text-white rounded-md hover:bg-red-600 transition duration-200 shadow-sm text-xs sm:text-sm"
                    >
                        Hapus
                    </button>` : ''}
                `;

                // Attach event listeners for name and vocal detail changes
                div.querySelector(`#main-char-name-${char.id}`).addEventListener('input', (e) => {
                    const charId = parseInt(e.target.id.split('-')[3]);
                    const charIndex = state.mainCharacters.findIndex(c => c.id === charId);
                    if (charIndex !== -1) { state.mainCharacters[charIndex].name = e.target.value; }
                });
                div.querySelector(`#main-char-vocal-${char.id}`).addEventListener('input', (e) => {
                    const charId = parseInt(e.target.id.split('-')[3]);
                    const charIndex = state.mainCharacters.findIndex(c => c.id === charId);
                    if (charIndex !== -1) { state.mainCharacters[charIndex].vocalDetail = e.target.value; }
                });

                // Attach event listener for remove button
                const removeBtn = div.querySelector('button[data-char-id]');
                if (removeBtn) {
                    removeBtn.addEventListener('click', (e) => {
                        const charIdToRemove = parseInt(e.target.dataset.charId);
                        state.mainCharacters = state.mainCharacters.filter(c => c.id !== charIdToRemove);
                        renderMainCharacters(); // Re-render characters after removal
                    });
                }

                container.appendChild(div);
            });
        }

        /**
         * Adds a new main character input field.
         */
        function addMainCharacter() {
            const newId = state.mainCharacters.length > 0 ? Math.max(...state.mainCharacters.map(c => c.id)) + 1 : 1;
            state.mainCharacters.push({ id: newId, name: '', vocalDetail: '' });
            renderMainCharacters(); // Re-render to show new field
        }

        /**
         * Renders the dialog character input fields into the DOM.
         */
        function renderCharacters() {
            const container = document.getElementById('characters-container');
            container.innerHTML = ''; // Clear existing dialog characters

            state.characters.forEach((char, index) => {
                const div = document.createElement('div');
                div.className = 'flex flex-col sm:flex-row gap-2 sm:gap-4 mb-3 sm:mb-4 p-3 sm:p-4 border border-purple-200 rounded-md bg-purple-100'; // Changed background/border for visual distinction
                div.innerHTML = `
                    <div class="flex-1">
                        <label for="char-name-${char.id}" class="block text-xs sm:text-sm font-medium text-purple-600 mb-1">
                            Karakter Dialog ${index + 1} (Nama/Deskripsi):
                        </label>
                        <input
                            type="text"
                            id="char-name-${char.id}"
                            class="w-full p-2 border border-purple-300 rounded-md focus:ring-1 focus:ring-purple-400 transition duration-200 text-sm"
                            value="${char.name}"
                            placeholder="Nama Karakter Dialog ${index + 1}..."
                        >
                    </div>
                    <div class="flex-1">
                        <label for="char-dialog-${char.id}" class="block text-xs sm:text-sm font-medium text-purple-600 mb-1">
                            Kalimat yang Diucapkan:
                        </label>
                        <input
                            type="text"
                            id="char-dialog-${char.id}"
                            class="w-full p-2 border border-purple-300 rounded-md focus:ring-1 focus:ring-purple-400 transition duration-200 text-sm"
                            value="${char.dialog}"
                            placeholder="Dialog karakter..."
                        >
                    </div>
                    ${state.characters.length > 2 ? `
                    <button
                        type="button"
                        data-char-id="${char.id}"
                        class="self-end sm:self-center px-3 py-1 sm:px-4 sm:py-2 bg-red-500 text-white rounded-md hover:bg-red-600 transition duration-200 shadow-sm text-xs sm:text-sm"
                    >
                        Hapus
                    </button>` : ''}
                `;

                div.querySelector(`#char-name-${char.id}`).addEventListener('input', (e) => {
                    const charId = parseInt(e.target.id.split('-')[2]);
                    const charIndex = state.characters.findIndex(c => c.id === charId);
                    if (charIndex !== -1) { state.characters[charIndex].name = e.target.value; }
                });
                div.querySelector(`#char-dialog-${char.id}`).addEventListener('input', (e) => {
                    const charId = parseInt(e.target.id.split('-')[2]);
                    const charIndex = state.characters.findIndex(c => c.id === charId);
                    if (charIndex !== -1) { state.characters[charIndex].dialog = e.target.value; }
                });

                const removeBtn = div.querySelector('button[data-char-id]');
                if (removeBtn) {
                    removeBtn.addEventListener('click', (e) => {
                        const charIdToRemove = parseInt(e.target.dataset.charId);
                        state.characters = state.characters.filter(c => c.id !== charIdToRemove);
                        renderCharacters();
                    });
                }
                container.appendChild(div);
            });
        }

        /**
         * Adds a new dialog character input field.
         */
        function addCharacter() {
            const newId = state.characters.length > 0 ? Math.max(...state.characters.map(c => c.id)) + 1 : 1;
            state.characters.push({ id: newId, name: '', dialog: '' });
            renderCharacters();
        }

        /**
         * Helper to build the Indonesian prompt string from current state.
         * @param {object} currentState - The current state object.
         * @returns {string} - The constructed Indonesian prompt string.
         */
        function buildIndonesianPromptString(currentState) {
            let prompt = '';
            
            if (currentState.mainCharacters.length > 0 && currentState.mainCharacters.some(c => c.name || c.vocalDetail)) { // Check if any main character has content
                prompt += `Karakter Utama:\n`;
                currentState.mainCharacters.forEach((char, index) => {
                    if (char.name || char.vocalDetail) { // Only add if name or vocalDetail is present
                        prompt += `- Karakter ${index + 1}: **${char.name || 'Tidak Bernama'}**`;
                        prompt += char.vocalDetail ? `, Detail Suara/Vokal: ${char.vocalDetail}` : '';
                        prompt += '.\n';
                    }
                });
            }

            prompt += currentState.subject ? `1. Subjek utama: **${currentState.subject}**.\n` : '';
            prompt += currentState.subjectDetails ? `2. Detail fisik dan perilaku subjek: **${currentState.subjectDetails}**.\n` : '';
            prompt += currentState.action ? `3. Subjek sedang: **${currentState.action}**.\n` : '';
            prompt += currentState.expression ? `4. Dengan ekspresi: **${currentState.expression}**.\n` : '';
            prompt += currentState.place ? `5. Berlatar tempat: **${currentState.place}**.\n` : '';
            prompt += currentState.time ? `6. Pada waktu: **${currentState.time}**.\n` : '';
            prompt += currentState.cameraMovement ? `7. Gerakan kamera yang digunakan: **${currentState.cameraMovement}**.\n` : '';
            prompt += currentState.lighting ? `8. Pencahayaan: **${currentState.lighting}**.\n` : '';
            prompt += currentState.videoStyle ? `9. Gaya video: **${currentState.videoStyle}**.\n` : '';
            prompt += currentState.videoAtmosphere ? `10. Suasana video: **${currentState.videoAtmosphere}**.\n` : '';
            prompt += currentState.soundMusic ? `11. Suara atau Musik: **${currentState.soundMusic}**.\n` : '';

            const activeDialogCharacters = currentState.characters.filter(c => c.name.trim() !== '' || c.dialog.trim() !== '');
            if (activeDialogCharacters.length > 0) {
                prompt += `12. Subjek karakter dialog melibatkan ${activeDialogCharacters.length} orang:\n`;
                activeDialogCharacters.forEach(char => {
                    prompt += `- **${char.name || 'Karakter tanpa nama'}**: `;
                    prompt += char.dialog ? `Mengucapkan "${char.dialog}".\n` : 'Tidak mengucapkan dialog.\n';
                });
            }

            prompt += currentState.additionalDetails ? `13. Detail tambahan: **${currentState.additionalDetails}**.\n` : '';
            return prompt;
        }

        /**
         * Calls the Gemini API to translate and enhance the prompt or get suggestions.
         * @param {string} promptToSend - The prompt to send to Gemini.
         * @param {string} currentApiKey - The API key to use for the current attempt.
         * @returns {Promise<string>} - A promise that resolves with the generated text from Gemini.
         */
        async function callGeminiAPI(promptToSend, currentApiKey) {
            let chatHistory = [];
            chatHistory.push({ role: "user", parts: [{ text: promptToSend }] });
            const payload = { contents: chatHistory };
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${currentApiKey}`;

            const response = await fetch(apiUrl, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });

            if (!response.ok) {
                const errorData = await response.json();
                console.error('API Error:', errorData);
                throw new Error(`API request failed with status ${response.status}: ${JSON.stringify(errorData)}`);
            }

            const result = await response.json();
            if (result.candidates && result.candidates.length > 0 &&
                result.candidates[0].content && result.candidates[0].content.parts &&
                result.candidates[0].content.parts.length > 0) {
                return result.candidates[0].content.parts[0].text;
            } else {
                console.warn("Gemini API response structure unexpected or content missing.");
                throw new Error("Unexpected API response structure or no content from Gemini.");
            }
        }

        /**
         * Generates the Indonesian and English prompts based on current state.
         */
        async function generatePrompt() {
            try {
                if (state.apiKeys.length === 0) {
                    showMessage('Mohon masukkan API Key Anda di bagian JavaScript kode ini.');
                    return;
                }

                state.currentApiKeyIndex = 0; // Reset index for a new generation attempt
                showLoading(true, 'Menyusun prompt...');

                // Get current values from all input fields
                // Ensure mainCharacters array is updated from DOM before building prompt string
                state.mainCharacters = Array.from(document.querySelectorAll('#main-characters-container > div')).map(div => {
                    const id = parseInt(div.querySelector('input[id^="main-char-name-"]').id.split('-')[3]);
                    const name = div.querySelector('input[id^="main-char-name-"]').value.trim();
                    const vocalDetail = div.querySelector('input[id^="main-char-vocal-"]').value.trim();
                    return { id, name, vocalDetail };
                }).filter(char => char.name !== '' || char.vocalDetail !== '');

                // Ensure dialog characters are also updated from DOM
                state.characters = Array.from(document.querySelectorAll('#characters-container > div')).map(div => {
                    const id = parseInt(div.querySelector('input[id^="char-name-"]').id.split('-')[2]);
                    const name = div.querySelector('input[id^="char-name-"]').value.trim();
                    const dialog = div.querySelector('input[id^="char-dialog-"]').value.trim();
                    return { id, name, dialog };
                }).filter(char => char.name !== '' || char.dialog !== '');


                state.subject = document.getElementById('subject').value.trim();
                state.subjectDetails = document.getElementById('subjectDetails').value.trim();
                state.action = document.getElementById('action').value.trim();
                state.expression = document.getElementById('expression').value.trim();
                state.place = document.getElementById('place').value.trim();
                state.time = document.getElementById('time').value.trim();
                state.cameraMovement = document.getElementById('cameraMovement').value.trim(); 
                state.lighting = document.getElementById('lighting').value.trim();
                state.videoStyle = document.getElementById('videoStyle').value.trim();
                state.videoAtmosphere = document.getElementById('videoAtmosphere').value.trim();
                state.soundMusic = document.getElementById('soundMusic').value.trim();
                state.additionalDetails = document.getElementById('additionalDetails').value.trim();

                const idPrompt = buildIndonesianPromptString(state);
                document.getElementById('indonesian-prompt-output').value = idPrompt;

                let englishPromptFromAI = '';
                let apiCallSuccessful = false;

                while (!apiCallSuccessful && state.currentApiKeyIndex < state.apiKeys.length) {
                    const currentKey = state.apiKeys[state.currentApiKeyIndex];
                    showLoading(true, `Menggunakan API Key #${state.currentApiKeyIndex + 1} dari ${state.apiKeys.length} untuk terjemahan...`);
                    try {
                        let mainCharsPromptPart = '';
                        if (state.mainCharacters.length > 0 && state.mainCharacters.some(c => c.name || c.vocalDetail)) {
                            mainCharsPromptPart = 'Focus on the following main characters:\n';
                            state.mainCharacters.forEach(char => {
                                if (char.name) {
                                    mainCharsPromptPart += `- Character name: "${char.name}"`;
                                    if (char.vocalDetail) {
                                        mainCharsPromptPart += `, with distinct vocal characteristics: "${char.vocalDetail}"`;
                                    }
                                    mainCharsPromptPart += '.\n';
                                } else if (char.vocalDetail) { // If name is empty but vocalDetail is present
                                     mainCharsPromptPart += `- Character with vocal characteristics: "${char.vocalDetail}".\n`;
                                }
                            });
                            if (mainCharsPromptPart !== 'Focus on the following main characters:\n') {
                                mainCharsPromptPart += "\n"; // Add a newline for separation
                            } else {
                                mainCharsPromptPart = ''; // If no valid main characters were added
                            }
                        }

                        const promptToGemini = `
Translate the following Indonesian video prompt into a highly detailed and descriptive English prompt for Veo 3. Ensure it captures all nuances and elaborates on elements where possible, making it ready for direct use in an AI video generation model.
${mainCharsPromptPart}
For "Subject," provide vivid descriptions of their type and key attributes.
For "Subject Details," focus on specific visual cues (clothing, unique features) and recurring mannerisms.
For "Action," use strong verbs and describe the intent, speed, or quality of movement.
For "Expression," detail facial expressions and body language that convey emotion.
For "Place," paint a rich picture of the environment, including key objects, layout, and overall atmosphere.
For "Time," specify hours, seasons, or historical/futuristic periods.
For "Camera Movement," articulate the camera's path, speed, and specific focus points.
For "Lighting," describe the light source, its quality (soft, harsh), and color temperature.
For "Video Style," provide a clear artistic direction or film genre.
For "Video Atmosphere," evoke sensory feelings and the overall mood.
For "Sound or Music," specify instruments, genres, tempos, and distinct sound effects.
If there are dialogues, maintain them exactly as they are provided, without translation.

Indonesian Prompt:
${idPrompt}

English Prompt (for Veo 3):
`;
                        englishPromptFromAI = await callGeminiAPI(promptToGemini, currentKey);
                        apiCallSuccessful = true;
                    } catch (error) {
                        console.error(`Error with API Key #${state.currentApiKeyIndex + 1}:`, error);
                        state.currentApiKeyIndex++;
                        if (state.currentApiKeyIndex < state.apiKeys.length) {
                            showLoading(true, `API Key #${state.currentApiKeyIndex + 1} gagal. Mencoba API Key berikutnya...`);
                            await new Promise(resolve => setTimeout(resolve, 1500));
                        } else {
                            englishPromptFromAI = "Semua API Key gagal menghasilkan prompt. Mohon periksa kunci Anda atau coba lagi nanti.";
                            console.error("All API keys failed to generate prompt.");
                        }
                    }
                }

                if (!apiCallSuccessful) {
                    englishPromptFromAI = "Gagal menghasilkan prompt Bahasa Inggris setelah mencoba semua API Key yang tersedia. Mohon periksa kunci Anda atau koneksi internet.";
                }

                document.getElementById('english-prompt-output').value = englishPromptFromAI;

                const outputSection = document.getElementById('output-section');
                outputSection.classList.remove('hidden');
                outputSection.scrollIntoView({ behavior: 'smooth', block: 'start' });

            } catch (outerError) {
                console.error("Terjadi kesalahan tak terduga selama pembuatan prompt:", outerError);
                showMessage("Terjadi kesalahan tak terduga saat membuat prompt. Mohon coba lagi. Detail: " + outerError.message);
            } finally {
                showLoading(false); // Ensure loading stops in all cases
            }
        }

        /**
         * Fetches prompt enrichment suggestions from Gemini API.
         */
        async function getSuggestions() {
            try {
                if (state.apiKeys.length === 0) {
                    showMessage('Mohon masukkan API Key Anda di bagian JavaScript kode ini.');
                    return;
                }

                state.currentApiKeyIndex = 0; // Reset index for a new attempt
                showLoading(true, 'Mendapatkan saran pengayaan dari AI...');

                // Ensure mainCharacters array is updated from DOM before building prompt string
                state.mainCharacters = Array.from(document.querySelectorAll('#main-characters-container > div')).map(div => {
                    const id = parseInt(div.querySelector('input[id^="main-char-name-"]').id.split('-')[3]);
                    const name = div.querySelector('input[id^="main-char-name-"]').value.trim();
                    const vocalDetail = div.querySelector('input[id^="main-char-vocal-"]').value.trim();
                    return { id, name, vocalDetail };
                }).filter(char => char.name !== '' || char.vocalDetail !== '');
                
                // Ensure dialog characters are also updated from DOM
                state.characters = Array.from(document.querySelectorAll('#characters-container > div')).map(div => {
                    const id = parseInt(div.querySelector('input[id^="char-name-"]').id.split('-')[2]);
                    const name = div.querySelector('input[id^="char-name-"]').value.trim();
                    const dialog = div.querySelector('input[id^="char-dialog-"]').value.trim();
                    return { id, name, dialog };
                }).filter(char => char.name !== '' || char.dialog !== '');


                state.subject = document.getElementById('subject').value.trim();
                state.subjectDetails = document.getElementById('subjectDetails').value.trim();
                state.action = document.getElementById('action').value.trim();
                state.expression = document.getElementById('expression').value.trim();
                state.place = document.getElementById('place').value.trim();
                state.time = document.getElementById('time').value.trim();
                state.cameraMovement = document.getElementById('cameraMovement').value.trim(); 
                state.lighting = document.getElementById('lighting').value.trim();
                state.videoStyle = document.getElementById('videoStyle').value.trim();
                state.videoAtmosphere = document.getElementById('videoAtmosphere').value.trim();
                state.soundMusic = document.getElementById('soundMusic').value.trim();
                state.additionalDetails = document.getElementById('additionalDetails').value.trim();
                
                const currentIdPrompt = buildIndonesianPromptString(state);

                let suggestionsFromAI = '';
                let apiCallSuccessful = false;

                while (!apiCallSuccessful && state.currentApiKeyIndex < state.apiKeys.length) {
                    const currentKey = state.apiKeys[state.currentApiKeyIndex];
                    showLoading(true, `Mendapatkan saran dengan API Key #${state.currentApiKeyIndex + 1} dari ${state.apiKeys.length}...`);
                    try {
                        const promptToGeminiForSuggestions = `
Berdasarkan detail prompt video Bahasa Indonesia berikut, berikan saran pengayaan yang kreatif dan singkat (maksimal 2 kalimat per kategori) untuk setiap kategori yang relevan agar prompt lebih vivid dan menarik untuk model AI video seperti Veo 3. Fokus pada penambahan detail deskriptif yang kaya. Jangan menerjemahkan prompt asli atau dialog.

Format output saran per kategori:
Karakter Utama: [Saran pengayaan untuk nama dan detail suara/vokal, penampilan, atau kepribadian khusus]
Subjek: [Saran pengayaan untuk jenis subjek dan atribut kuncinya]
Detail Fisik & Perilaku Subjek: [Saran pengayaan untuk visual spesifik dan kebiasaan]
Aksi: [Saran pengayaan untuk kekuatan kata kerja, tujuan, dan kualitas gerakan]
Ekspresi: [Saran pengayaan untuk ekspresi wajah dan bahasa tubuh]
Tempat: [Saran pengayaan untuk objek penting, tata letak, dan suasana tempat]
Waktu: [Saran pengayaan untuk jam spesifik, musim, atau era/periode]
Gerakan Kamera: [Saran pengayaan untuk jalur kamera, kecepatan, dan titik fokus]
Pencahayaan: [Saran pengayaan untuk jenis, sumber, dan efek cahaya]
Gaya Video: [Saran pengayaan untuk arah artistik, genre film, atau gaya rendering]
Suasana Video: [Saran pengayaan untuk perasaan sensorik dan suasana keseluruhan]
Suara atau Musik: [Saran pengayaan untuk instrumen, genre, tempo, atau efek suara spesifik]
Subjek Karakter Dialog: [Saran pengayaan untuk karakteristik vokal atau gaya penyampaian dialog]
Detail Tambahan: [Saran pengayaan untuk properti spesifik, interaksi objek, komposisi visual kompleks]

---
Prompt Video Anda:
${currentIdPrompt}
---
Saran Pengayaan:
`;
                                suggestionsFromAI = await callGeminiAPI(promptToGeminiForSuggestions, currentKey);
                                apiCallSuccessful = true;
                            } catch (error) {
                                console.error(`Error getting suggestions with API Key #${state.currentApiKeyIndex + 1}:`, error);
                                state.currentApiKeyIndex++;
                                if (state.currentApiKeyIndex < state.apiKeys.length) {
                                    showLoading(true, `API Key #${state.currentApiKeyIndex + 1} gagal untuk saran. Mencoba API Key berikutnya...`);
                                    await new Promise(resolve => setTimeout(resolve, 1500));
                                } else {
                                    suggestionsFromAI = "Semua API Key gagal mendapatkan saran. Mohon periksa kunci Anda atau coba lagi nanti.";
                                }
                            }
                        }

                        if (!apiCallSuccessful) {
                            suggestionsFromAI = "Gagal mendapatkan saran pengayaan setelah mencoba semua API Key yang tersedia. Mohon periksa kunci Anda atau koneksi internet.";
                        }

                        document.getElementById('ai-suggestions-output').value = suggestionsFromAI;
                        const suggestionsOutputSection = document.getElementById('suggestions-output-section');
                        suggestionsOutputSection.classList.remove('hidden');
                        suggestionsOutputSection.scrollIntoView({ behavior: 'smooth', block: 'start' });

                    } catch (outerError) {
                        console.error("Terjadi kesalahan tak terduga selama mendapatkan saran:", outerError);
                        showMessage("Terjadi kesalahan tak terduga saat mendapatkan saran. Mohon coba lagi. Detail: " + outerError.message);
                    } finally {
                        showLoading(false);
                    }
                }


                document.addEventListener('DOMContentLoaded', () => {
                    // IMPORTANT: Place your Gemini API keys directly in this array
                    // If you have multiple keys, separate them with commas.
                    // Example: state.apiKeys = ['AIzaSyA_YourKey1...', 'AIzaSyB_YourKey2...', 'AIzaSyC_YourKey3...'];
                    state.apiKeys = ['AIzaSyB0PIhawy0uCRyA0M5rSdTfGvGbtyo9uK8']; // <-- PASTE YOUR API KEYS HERE, e.g., ['YOUR_KEY_1', 'YOUR_KEY_2']

                    // Render main characters and dialog characters on load
                    renderMainCharacters(); // Now ensures at least one field is present
                    renderCharacters();

                    // Attach event listeners for adding characters
                    document.getElementById('add-main-character-btn').addEventListener('click', addMainCharacter); // NEW
                    document.getElementById('add-character-btn').addEventListener('click', addCharacter);

                    // Attach event listeners for main actions
                    document.getElementById('generate-prompt-btn').addEventListener('click', generatePrompt);
                    document.getElementById('get-suggestions-btn').addEventListener('click', getSuggestions);

                    // Attach login/logout event listeners
                    document.getElementById('login-btn').addEventListener('click', performLogin);
                    document.getElementById('logout-btn').addEventListener('click', logout);
                    
                    // Allow pressing Enter key to login
                    document.getElementById('login-password').addEventListener('keypress', function(event) {
                        if (event.key === 'Enter') {
                            performLogin();
                        }
                    });

                    // Attach input listeners to all text fields to update state in real-time
                    document.getElementById('subject').addEventListener('input', (e) => state.subject = e.target.value.trim());
                    document.getElementById('subjectDetails').addEventListener('input', (e) => state.subjectDetails = e.target.value.trim());
                    document.getElementById('action').addEventListener('input', (e) => state.action = e.target.value.trim());
                    document.getElementById('expression').addEventListener('input', (e) => state.expression = e.target.value.trim());
                    document.getElementById('place').addEventListener('input', (e) => state.place = e.target.value.trim());
                    document.getElementById('time').addEventListener('input', (e) => state.time = e.target.value.trim());
                    document.getElementById('cameraMovement').addEventListener('input', (e) => state.cameraMovement = e.target.value.trim()); 
                    document.getElementById('lighting').addEventListener('input', (e) => state.lighting = e.target.value.trim());
                    document.getElementById('videoStyle').addEventListener('input', (e) => state.videoStyle = e.target.value.trim());
                    document.getElementById('videoAtmosphere').addEventListener('input', (e) => state.videoAtmosphere = e.target.value.trim());
                    document.getElementById('soundMusic').addEventListener('input', (e) => state.soundMusic = e.target.value.trim());
                    document.getElementById('additionalDetails').addEventListener('input', (e) => state.additionalDetails = e.target.value.trim());

                    // Check login state when the page finishes loading
                    checkLoginStateOnLoad();
                });
            </script>
        </body>
        </html>
        </body>
        </html>
